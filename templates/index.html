<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Listener</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Telegram Listener</h2>
        <form id="telegramForm">
            <div class="mb-3">
                <label for="api_id" class="form-label">API ID</label>
                <input type="text" class="form-control" id="api_id" name="api_id" required>
            </div>
            <div class="mb-3">
                <label for="api_hash" class="form-label">API Hash</label>
                <input type="text" class="form-control" id="api_hash" name="api_hash" required>
            </div>
            <div class="mb-3">
                <label for="phone_number" class="form-label">Phone Number</label>
                <input type="text" class="form-control" id="phone_number" name="phone_number" required>
            </div>
            <hr>
            <h4>MEXC API Credentials</h4>
            <div class="mb-3">
                <label for="mexc_api_key" class="form-label">MEXC API Key</label>
                <input type="text" class="form-control" id="mexc_api_key" name="mexc_api_key" required>
            </div>
            <div class="mb-3">
                <label for="mexc_api_secret" class="form-label">MEXC API Secret</label>
                <input type="text" class="form-control" id="mexc_api_secret" name="mexc_api_secret" required>
            </div>
            <hr>
            <h4>BingX API Credentials</h4>
            <div class="mb-3">
                <label for="bingx_api_key" class="form-label">BingX API Key</label>
                <input type="text" class="form-control" id="bingx_api_key" name="bingx_api_key" required>
            </div>
            <div class="mb-3">
                <label for="bingx_api_secret" class="form-label">BingX API Secret</label>
                <input type="text" class="form-control" id="bingx_api_secret" name="bingx_api_secret" required>
            </div>
            <button type="submit" class="btn btn-primary">Start</button>
        </form>
        <div id="response" class="mt-3"></div>

        <h3 class="mt-4">Live Logs</h3>
        <div id="logOutput" class="border p-3 bg-light" style="height: 300px; overflow-y: scroll;"></div>
    </div>

    <script>
        document.getElementById("telegramForm").addEventListener("submit", function(event) {
            event.preventDefault();
            const formData = new FormData(this);
            fetch("/start", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("response").innerHTML = `<div class='alert alert-success'>${data.status}</div>`;
            })
            .catch(error => {
                document.getElementById("response").innerHTML = `<div class='alert alert-danger'>Error starting listener</div>`;
            });
        });

        var socket = io();
        socket.on('log', function(data) {
            const logOutput = document.getElementById("logOutput");
            logOutput.innerHTML += `<div>${data.message}</div>`;
            logOutput.scrollTop = logOutput.scrollHeight;
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>